<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ëª…í•¨ PDF ìƒì„±ê¸°</title>
</head>
<body>
  <h2>ëª…í•¨ ì •ë³´ ì…ë ¥</h2>
  <form id="infoForm">
    <label>êµ­ë¬¸ ì´ë¦„: <input name="kor_name" value="ê¹€íƒœê¸¸" /></label><br />
    <label>êµ­ë¬¸ ì†Œì†: <input name="kor_dept" value="ì‹ ìš©ëŒ€ì¶œìŠ¤ì¿¼ë“œ" /></label><br />
    <label>êµ­ë¬¸ ì§í•¨: <input name="kor_title" value="íŒ€ì¥" /></label><br />
    <button type="submit">PDF ë‹¤ìš´ë¡œë“œ</button>
  </form>

  <script>
    document.getElementById("infoForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const form = e.target;
      const korName = form.elements["kor_name"].value.trim();
      const korDept = form.elements["kor_dept"].value.trim();
      const korTitle = form.elements["kor_title"].value.trim();

      console.log("ğŸ“¦ ìš”ì²­ ë°ì´í„°:", { korName, korDept, korTitle });

      try {
        const response = await fetch("https://kbalda-pdf-generator.onrender.com/generate", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            name: korName,
            dept: korDept,
            title: korTitle,
          }),
        });

        if (!response.ok) {
          throw new Error(`ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: ${response.status}`);
        }

        const blob = await response.blob();
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "namecard.pdf";
        a.click();
        URL.revokeObjectURL(url);
        console.log("âœ… PDF ë‹¤ìš´ë¡œë“œ ì™„ë£Œ");
      } catch (error) {
        console.error("âŒ PDF ìƒì„± ì˜¤ë¥˜:", error);
        alert("PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
      }
    });
  </script>
</body>
</html>
